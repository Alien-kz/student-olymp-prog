\documentclass[12pt, a4paper]{article}

\usepackage[T2A]{fontenc}		%cyrillic output
\usepackage[utf8]{inputenc}		%cyrillic output
\usepackage[english, russian]{babel}	%word wrap
\usepackage{amssymb, amsfonts, amsmath}	%math symbols
\usepackage{mathtext}			%text in formulas
\usepackage{geometry}			%paper format attributes
\usepackage{fancyhdr}			%header
\usepackage{graphicx}			%input pictures
\usepackage{tikz}				%draw pictures
\usetikzlibrary{patterns}		%draw pictures: fill
\usetikzlibrary{calc}			%draw pictures: coordinate calc
% \usetikzlibrary{external}		%draw pictures: cache pitcures
% \tikzexternalize				%cache pictures
\usepackage{listofitems}		%list of arguments (pictures)
\usepackage{enumitem}			%enumarate parameters
\usepackage{titlesec}			%new subsection option


\geometry{left=1cm, right=1cm, top=2cm, bottom=1cm, headheight=15pt}
\setlist[enumerate]{leftmargin=*}	%remove enumarate indenttion
\sloppy							%correct overfull
\newcommand{\subsectionbreak}{\clearpage} %new section

\newcommand{\head}[4]
{
	\pagestyle{fancy}
	\fancyhf{}
	\lhead{#3 \\ #2}
	\rhead{#1}
}


% format

\newcommand{\informat}[1]
{
	\paragraph{Ввод.\\} #1
}

\newcommand{\outformat}[1]
{
	\paragraph{Вывод.\\} #1
}

\newcommand{\example}[2]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|}
	\hline
	Ввод & Вывод \\
	\hline
	#1 & #2		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\examplee}[4]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|}
	\hline
	Ввод 	& Вывод  	\\
	\hline
	#1 		& #2 		\\
	\hline
	#3		& #4		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\examplEEE}[6]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.5\linewidth}|p{0.3\linewidth}|}
	\hline
	Ввод 	& Вывод  	\\
	\hline
	#1 		& #2 		\\
	\hline
	#3		& #4		\\
	\hline
	#5		& #6		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\exampleee}[6]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|}
	\hline
	Ввод 	& Вывод  	\\
	\hline
	#1 		& #2 		\\
	\hline
	#3		& #4		\\
	\hline
	#5		& #6		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\exampleeee}[8]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|}
	\hline
	Ввод 	& Вывод  	\\
	\hline
	#1 		& #2 		\\
	\hline
	#3		& #4		\\
	\hline
	#5		& #6		\\
	\hline
	#7		& #8		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\exampleeeee}[5]
{
	\paragraph{Пример.\\}
	{\tt
	\begin{tabular}{|p{0.4\linewidth}|p{0.4\linewidth}|}
	\hline
	Ввод 	& Вывод  	\\
	\hline
	#1		\\
	\hline
	#2		\\
	\hline
	#3		\\
	\hline
	#4		\\
	\hline
	#5		\\
	\hline
	\end{tabular}
	}
}

\newcommand{\examplepic}[3]
{
	\subsection*{Пример.}
	{\tt
	\noindent
	\begin{tabular}{|p{0.1\linewidth}|p{0.1\linewidth}|p{0.5\linewidth}|}
	\hline
	Ввод 	& Вывод  	& Пояснение\\
	\hline
	#1 		& #2 		& #3\\
	\hline
	\end{tabular}
	}
}


\newcommand{\excomm}[1]
{
	\paragraph{Комментарий. \\}
	\textit{#1}
}

\begin{document}

\head{Открытая олимпиада по программированию \\ Весенний тур 2016}{30 апреля 2016}{Казахстанский филиал МГУ имени М.В.Ломоносова}{г.~Астана}

\subsection*{A. Alexandra’s subtractions}

Саша в совершенстве владеет мастерством сортировки чисел, поэтому для настоящего вызова ей нужна по-настоящему сложная задача. Она решила, что будет сортировать не множество чисел, а всевозможные попарные разности чисел этого множества. Например, для множества \{1, 10, 5, 7\} она получит ответ \mbox{\{-9, -6, -5, -4, -3, -2, 2, 3, 4, 5, 6, 9\}}, а для множества \{1, 2, 3\} ответом будет \mbox{\{-2, -1, -1, 1, 1, 2\}}. Задача довольно сложная, поэтому мы вас просим найти только второе максимальное число в полученном наборе.

\informat{В первой строке одно целое число $n$, где $3 \le n \le 10^5$. \newline
Во второй строке $n$ различных целых чисел $a_1$, $\dots$, $a_n$, где $1 \le a_i \le 10^6$.}

\outformat{Одно целое число --- вторая максимальная разность.}

\example{4 \newline 1 10 5 7}{6}



\subsection*{B. Book of all the words}

Денис решил выучить язык моржей. Оказалось, что алфавит моржей состоит из $n$ букв, которые совпадают с $n$ первыми буквами английского алфавита, а язык --- из всевозможных слов длины $m$. Денис настроен решительно, поэтому он даже купил словарь, в котором все слова расположены по алфавиту. Подскажите Денису $k$-ое слово в словаре, чтобы помочь ему в изучении языка.

\informat{Три целых числа $n$, $m$, $k$, где $2 \le n \le 26$, $1 \le k \le n^m \le 10^{18}$.}

\outformat{Строка из $n$ строчных латинских букв.}

\exampleee{3 5 6}{aaabc}{26 3 1739}{cow}{20 4 99431}{milk}

\excomm{В первом примере словарь будет начинаться со слов: \textit{aaaaa}, \textit{aaaab}, \textit{aaaac}, \textit{aaaba}, \textit{aaabb}, \textit{aaabc}, \textit{aaaca}, $\dots$ .}



\subsection*{C. Changing the word}

Беда! Ответ Ерулана на задачу никак не хочет сходиться с тем, что указан в конце задачника. Чтобы подогнать своё слово (а ответом является именно слово) под правильное, он может за один шаг использовать одну из трех операций:
\begin{enumerate}
\item добавить одну любую букву в начало или конец слова;
\item убрать первую или последнюю букву слова;
\item заменить каждую букву слова на симметричную ей относительно центра алфавита (то есть, \textit{'a'} на \textit{'z'}, \textit{'b'} на \textit{'y'}, $\dots$, \textit{'z'} на \textit{'a'}).
\end{enumerate}
Чтобы Ерулана мог побольше поспать, он хочет как можно быстрее справиться с этим заданием. За какое минимальное число действий он сможет привести свою строчку к правильной?

\informat{В первой строке строка из не более чем 1000 строчных латинских букв, оканчивающаяся точкой, --- ответ Ерулана. \newline 
Во второй строке правильный ответ в таком же формате.}

\outformat{Одно целое число --- минимальное число операций, за которое первую строку можно привести ко второй.}

\examplee{drop. \newline milk.}{3}{hardcore. \newline texlive.}{8}

\excomm{В первом примере один из вариантов правильной последовательности может выглядеть так: $drop \rightarrow rop \rightarrow ilk \rightarrow milk$.}



\subsection*{D. Doubtful numbers}

Али любит вводить новые термины и обозначения. Например, составные числа, имеющие больше простых делителей, чем составных, он решил называть сомнительными. Скажите, сколько сомнительных чисел найдёт Али среди всех целых чисел отрезка $[A, B]$?

\informat{Два целых числа $A$, $B$, где $1 \le A \le B \le 10^7$.}

\outformat{Одно целое число --- количество сомнительных чисел на отрезке $[A, B]$.}

\examplee{90 100}{4}{1 2016}{564}

\excomm{Число 90 не является сомнительным, поскольку имеет 3 простых делителя (2, 3 и 5) и 8 составных (6, 9, 10, 15, 18, 30, 45 и 90); число 91 же сомнительное, поскольку имеет 2 простых делителя (7 и 13) и только 1 составной (91). Другими сомнительными числами из первого примера будут 93, 94 и 95. Число 97 также имеет больше простых делителей, чем составных, но оно само является простым.}



\subsection*{E. Experiment with tea}

У Тимура есть стакан с квадратным основанием, в котором он выложил сахар-рафинад в аккуратные столбики. На дне стакана осталось место только под один кубик сахара. Чтобы сахар быстро не растворялся, он льет чай в именно в этот свободный квадрат. Какой максимальный объем чая он может налить в стакан так, чтобы чай не касался стенок стакана?

\input{pictures/2016-04-E}

\informat{В первой строке одно целое число $N$ от 1 до 100 --- сторона квадратного основания стакана, выраженная в кубиках сахара. \newline
В следующих $N$ строках ---  матрица $A$ размера $N \times N$ из целых чисел от 0 до $10^6$, где $a_{ij}$ --- высота соответствующего столбца. Гарантируется, что в матрице присутствует ровно один нулевой элемент, причем он не находится на границе матрицы.}

\outformat{Два целых числа: $h$ --- уровень чая в стакане в кубиках (при максимальном объеме) и $v$ --- максимальный объем налитого чая.}

\examplee{7 \newline
4 4 4 4 4 4 4  \newline
4 1 1 1 1 1 4  \newline
4 1 2 2 2 1 4  \newline
4 1 2 0 2 1 4  \newline
4 3 4 2 2 1 4  \newline
1 1 3 1 1 1 4  \newline
1 1 4 4 4 4 4}{3 36}
{3 \newline
2 3 4 \newline
9 0 5 \newline
8 7 6}{3 3}

\excomm{Сахар не тает и не пропускает чай.}



\subsection*{F. Five words}

\noindent
Коровы понимают каждое сказанное человеком слово, правда, только частично.

\noindent
Фермер рассказывал, что его коровы поели всю траву луга за 96 дней.

\noindent
Мы в таких случаях вспоминаем поговорку <<сидит как на корове седло>>.

\noindent
Говорят, загар улучшает лактацию и удой коровы.

\noindent
Убегать от коровы во сне --- к неожиданному разрешению финансовых проблем.

\informat{Целое число $n$, $1 \le n \le 35$.}

\outformat{Три строчных латинских буквы.}

\exampleeeee{4 & cow}{9 & ate}{18 & sit}{29 & tan}{33 & ran}



\subsection*{G. Glowing letters}

Надира открыла сеть из двух автосалонов. В них еще нет ни одной машины, но зато уже есть одинаковые вывески, сделанные из светящихся букв. Адиль сказал, что обладает авторскими правами на букву \textbf{'a'}, поэтому Надире нельзя ее использовать в названиях своих салонов. Она не может снять вывески целиком, но может оставить включенными некоторые буквы. На первой вывеске она может оставить включенной любую подстроку, а на второй вывеске --- любые буквы. Сколько различных способов у нее получить непустое название, не содержащее букву \textbf{'a'} для первой и второй вывески?

\informat{Cтрока из не более чем $10^5$ строчных латинских букв, оканчивающаяся точкой, --- старое общее название двух салонов.}

\outformat{Два целых числа: количество способов получить первую и вторую вывеску. Так как количество способов может быть очень большим числом, ответы следует выводить по модулю $10^9 + 7$.}

\examplee{calf.}{4 7}{calfandcalf.}{13 255}

\excomm{Полученные два названия не обязаны совпадать. Способ определяется позициями выключенных букв, а не значением. В первом примере допустимые названия первого салона: $c$, $l$, $f$, $lf$; второго салона: $c$, $l$, $f$, $cl$, $cf$, $lf$, $clf$.}



\subsection*{H. Harmonic permutations}

Мирас изучает свойства перестановок чисел от 1 до $2n$. Больше всего ему нравится порядок, но упорядоченных перестановок не так уж и много --- всего одна. Он решил посчитать количество частично упорядоченных перестановок $(a_1, a_2, ..., a_{2n})$, которые он назвал гармоничными:

\begin{enumerate}
\item $a_1$, $\dots$ , $a_n$ --- упорядочены по возрастанию;
\item $a_{n+1}$, $\dots$, $a_{2n}$ --- упорядочены по возрастанию;
\item $a_i < a_{i+n}$ для всех $i$ от 1 до $n$.
\end{enumerate}

Помогите Мирасу посчитать число таких перестановок.

\informat{Одно целое число $n$ от 1 до 1000.}

\outformat{Одно целое число --- число гармоничных перестановок чисел от 1 до $2n$. Так как число перестановок может быть очень большим, ответ следует выводить по модулю $10^9 + 7$.}

\examplee{2}{2}{3}{5}

\excomm{В первом примере существует 2 гармоничных перестановки:\\ \mbox{(1, 2, 3, 4)}, \mbox{(1, 3, 2, 4)}.}



\subsection*{I. Infinity problem}

Темирхан выписал на доске все натуральные числа, сумма цифр которых равна трём. Как он это сделал (ведь таких чисел бесконечно много!), вопрос к нему. Нас же интересует кое-что другое: есть ли среди этих чисел хотя бы одно кратное $n$?

\informat{Одно целое число $n$, где $1 \le n \le 10 000$.}

\outformat{Слово YES (если существует натуральное число с суммой цифр 3 и кратное $n$) или NO (если такого числа нет).}

\examplee{8}{YES}{9}{NO}

\excomm{В первом примере подходящим кратным является, например, число 120. Во втором примере таких чисел не найдётся, поскольку любое кратное 9 имеет также кратную 9 сумму цифр.}



\subsection*{J. Jelly cake}

У Ильи есть вкусный желейный круглый торт радиуса 1000 с $N$ ягодками на его окружности по краям торта. Он хочет отрезать себе треугольный кусок с тремя ягодками в вершинах. Какой минимальной площади он может выбрать кусок, чтобы на завтра осталось больше торта?

\informat{В первой строке одно целое число $N$, где $3 \le N \le 10000$, --- количество ягодок, расположенных на границе торта. \newline Каждая из следующих $N$ строк содержат по три числа: $g_i$, $m_i$, $s_i$ -- градусы, минуты и секунды угла, определяющего позицию $i$-й ягодки, где $0 \le g_i \le 359$, $0 \le m_i \le 59$, $0 \le s_i \le 59$.}

\outformat{Одно вещественное число --- минимальная площадь треугольного куска с вершинами в ягодках. Ответ больше 0.0001 засчитывается, если относительная погрешность не превосходит 0.0001. Остальные ответы можно считать нулевыми.}

\examplee{4 \newline
0 0 0\newline
90 0 0\newline
180 0 0\newline
270 0 0}{1000000.0}
{5 \newline
180 20 30\newline
120 20 30\newline
0 0 0\newline
45 45 45\newline
90 20 30}{118947.66}



\end{document} 
